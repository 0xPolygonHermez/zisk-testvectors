use ziskos::final_exp_bls12_381;

pub fn final_exp_tests() {
    // 0^{(p¹²-1)/r} = 0
    let a = [0; 72];
    let res = final_exp_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    // 1^{(p¹²-1)/r} = 1
    let a = {
        let mut tmp = [0; 72];
        tmp[0] = 1;
        tmp
    };
    let res = final_exp_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    // random tests
    let a = [
        0x3FAA8D81744136E8,
        0x25ECFBE39AF09ED2,
        0x8BCDC51D3AD3D49C,
        0x78B2EFF90DCFD55E,
        0x55C91A77155CFEAC,
        0x6E73C6CBB8510F4,
        0x3F3C46B95077257C,
        0xF6B7AAD7F4D2E5E3,
        0x8598DE9E4D0B1B27,
        0x80B309ADC403D559,
        0x6F93F8C07ECFF673,
        0x11406323A5B47DE4,
        0xD2D24A7C49B84E7C,
        0x168E532306213609,
        0x247811E665E4B9CA,
        0x52A732BDA74D8398,
        0x27E7D129534C5C7C,
        0xEC1CCEED76E0637,
        0xFC44905F1F7CD8BC,
        0x6AF4FBE03DA58FE6,
        0x32C9E8E352FD9F57,
        0xC78FB5C427E75997,
        0x87F13EE972C31E61,
        0x42E714DDB732F85,
        0xA59972E9678957A6,
        0xDB92FD518C5932B9,
        0x85961C24B58ABA15,
        0x6EEBD777318CE49B,
        0x445F12D64649C25C,
        0x4A8EC7CCBB93FA8,
        0x709BA3A71CFF16EE,
        0x1B33050A9F3A82E7,
        0x3352B98EFFB8688,
        0x1FB3E4B474D2215D,
        0xDB393F4667A5C3FD,
        0x5F8F34F67EF150F,
        0x4393209FF6871356,
        0x623E8166E48BD7FF,
        0x24570EF4DB7171F4,
        0x7A7FB1C45E689531,
        0x96CD2E33B6B71129,
        0x14C9616045FE3F11,
        0x6F9EEBD4DF6E61E3,
        0xEEB9817E22DFE8E4,
        0x3960AE0BE086CFD,
        0x516EE1C33356F388,
        0xA160DB2677D95666,
        0x18C1F7DABCB5518C,
        0x7AFE187032C5B9B4,
        0x9523FD9968D8AD12,
        0xA9B1FB56AAE07449,
        0xF25400768FFE5CD7,
        0xEE3976C32EE6482E,
        0x859536A96BC6EF,
        0xCCADE0063E929165,
        0x3D01CF6693DED37D,
        0x332714B91AE6F2D2,
        0x48FE899596162CC3,
        0xA5B4BFE41704FA8F,
        0x3642B811E0EC187,
        0x946D48E2D40C69,
        0x35793CBD0BB18165,
        0xEA3416AF6C8CA466,
        0xB656787270335957,
        0x1A18B396790A02A7,
        0x18851DFE259EAE0D,
        0xD7ED7E34C983A5C9,
        0xD2EBD093351A9DA4,
        0x860E1F8BA1FE6435,
        0x21730B7D99A7ACC4,
        0x77751D76FF4E7172,
        0x51228F8FE1AAD42,
    ];
    let res = final_exp_bls12_381(&a);
    let res_exp = [
        0xE9F76B934D089BD2,
        0xDFB446D92EB41119,
        0xF7AD8E3718E2F53D,
        0xFD982BDC042A5478,
        0xADD851AA48F9F66A,
        0x179411650DFF7199,
        0xC7AF91DE4B110A9C,
        0x8460A5EA688326C9,
        0x61DD65507B32008A,
        0x604DB6C9B4DC4715,
        0xEE8582B8E60B39D9,
        0x1031778C9C9434BB,
        0x999815EBD565519,
        0x2B6FE132A47EF956,
        0xEA26FADA37971ECC,
        0xC1B81A273FA6B86C,
        0x5DAAC39385290FBB,
        0x7E68CEFA6700AE8,
        0x7F3F9D4A27AE15DD,
        0x6185A6045D9540CA,
        0x45A1E75488E4B84D,
        0xDF2F4FD87EA41A72,
        0xE599E197788D6148,
        0x18496F18DE230234,
        0x74E21F525CF3810C,
        0x362601AF10D1AA57,
        0xBEE22E3660E76E93,
        0xE4640CFBD061D529,
        0x20B83E1F046EE101,
        0x6FDA3693555144,
        0xEF89038EB287E217,
        0xF00AEB0605CF1A1C,
        0x8C2DA687558049EF,
        0x254DC8021C026D1E,
        0x279C467D8541E8BA,
        0xFC8CDFD4A9339F,
        0x15983B9AEE139373,
        0xECE7E104FFE75D4C,
        0x23609D8B3D5389CA,
        0xC22E60223FEE761F,
        0x949A6578196143AF,
        0xD0FD539B41E354A,
        0x784B8E198D02FF5A,
        0x9EA92F97B0244296,
        0xF49E9C878ECA5618,
        0x96CDB838ACEA89AE,
        0xAE2C2D92B48D632E,
        0x6AF54072E5B0603,
        0xF6000E1C363138EA,
        0x7D577AECEA4BBC0,
        0xD7C492A5CEFC9C70,
        0x59E0BA34F53637BE,
        0x89742DA1EA5775,
        0x108DAEC66C4E1866,
        0xBC7ADCA58C724104,
        0x7C75591D513F9FB5,
        0x3CABA008FDF06998,
        0x712C1B6F89211936,
        0x65911503ED53F31B,
        0x10863EFFB74EC542,
        0xF5E4EA31790A4393,
        0x18287DF1CC5EA759,
        0x10DA7FA52DB1BC4C,
        0x582DEFA8EEF8F535,
        0xD4C656A35F0DEE5D,
        0x9488ECB3D4AED1B,
        0x45A9BE4A4FF993D7,
        0xD4E5649DEA88B9EF,
        0x956C568EE87925BE,
        0xF2EA693B34CF0422,
        0x649300BBDACB0C52,
        0x14F531C530CBB251,
    ];
    assert_eq!(res, res_exp);

    let a = [
        0xEE14A9DAD36D2FE7,
        0x7C3B6820FA81D123,
        0x25BC397EEBA7083A,
        0x68B7BCC939681997,
        0xA5443190DEAAAAB5,
        0xDEF55F6CE5ECAA7,
        0x7CE85F520B13F33D,
        0xE3D37DC01DA0F596,
        0x56C561340B56A8B8,
        0x34CACC0C264315D7,
        0x4E9FB28F772F7BE8,
        0xBD7D3C272972C1F,
        0x44AD1346AD784D18,
        0x771DD1519F84F0BE,
        0xBDCAF96C5A9C76A5,
        0x51788D35DB822E19,
        0x1A03979D4F54A3E4,
        0x6913034CB514836,
        0x93207854C5B4F83A,
        0x195C6FF41C5FA374,
        0xDC4F4D3DE45965BF,
        0x82B2991A016333E9,
        0x66C1C7B12BCF8AA2,
        0xCA87536CF4D5A12,
        0xD21DE6F5A07DA4B6,
        0x9FE4BBF787D909F9,
        0x6F52D46FBBB40549,
        0xCA485AA345F4B140,
        0x11E646FCB17F6C91,
        0xFEC29364A81F1D9,
        0xB03FBB6FFEBEAFB0,
        0x3E5BF4F264A75E16,
        0x9692C9D4AB523A8B,
        0x48356416F9B7B9F2,
        0x9E0A3C564C6F4C43,
        0x16ADFA0EFFCDB076,
        0xA5FD9BF6DCA44CCA,
        0xF46A0CFF910FEB91,
        0x691DC6B4C08E5840,
        0x9BFC5D938B267B3B,
        0x3AA3B269B3C974CB,
        0xDD98E669EE3185A,
        0x9BF2BC33FBCE8386,
        0x8805E4F92B9BC6D5,
        0x5C89617E0B620930,
        0xD487B61964C4D3F2,
        0xD49170C76EF7FBC7,
        0xF87E6CD493E1F5A,
        0xB8A36E3E7725FB7F,
        0x2E61C3D59C987AC2,
        0x41DA35439A30DA38,
        0x2C17BCEBD299225A,
        0xFE5759DB9A23FAB5,
        0x107DD0D712BBA613,
        0xEC802D3CAAF96B8,
        0x7C6AC0EDA06C53C4,
        0xBBDB441A2E7DC671,
        0x4D62918F3566C937,
        0x9708D77DE33A76F2,
        0x1485E44A20F92BBC,
        0x8786414C5186965B,
        0x4C97E52139E9F454,
        0x25B5F3C339D9EB2B,
        0x4D058C3A896B9719,
        0x7B111ED2201DC789,
        0x103A5D9D178E5674,
        0xA07C4597411E4237,
        0xB1D47F48320A4B8F,
        0xBA3731ED03617AAF,
        0xCB8132BFF965950D,
        0x4898D3C4A96ED6EB,
        0x10A82724F5D5D4E1,
    ];
    let res = final_exp_bls12_381(&a);
    let res_exp = [
        0xAA7203D32CD45BC2,
        0x77155F1C1C3B8416,
        0xABF7160B0954CCAF,
        0x3D6986E9AD64C746,
        0xBC0E369D18682515,
        0x8CA39BD02AA96BC,
        0xCF7E19E7BF4111F9,
        0x7206AC799D1C5FC6,
        0x844BCC8FB2949186,
        0xA563C87A67EE7CB7,
        0xAD31B595AADEF7AD,
        0x308190E93D426FB,
        0x37A3B48724A3FC88,
        0xACCB117B79AB8E93,
        0x89546A031B028211,
        0x8646E7DC5D5A8312,
        0xA263BBDDD6915B49,
        0xF72BA317ADFBC7F,
        0x5479D72BC53892B1,
        0x781A378021700F3D,
        0xCE995CAAD58ED653,
        0xE4DEAF7FED1D1495,
        0x15FFB49E286A28C3,
        0x112E48BA4B26247E,
        0xC42766B5C916668B,
        0x8745E121D9047B81,
        0xEB6DF06870AF12B6,
        0xB5C85CFC13018B33,
        0x18E60B33F2F92E86,
        0x15C12B02F19BCE76,
        0x42507CA20B1B282B,
        0xDFEF8AEE1D487DF2,
        0xB4F8679EA84B5F04,
        0x9BCABF3813D91B69,
        0x4E3603BCC4AC53CE,
        0x115ADB221E73415B,
        0xF5CBFFA09732713D,
        0xE72DDBEA47B58732,
        0x7DB20881EADDD01E,
        0xAF2B79853280B346,
        0xD280CDE1BA51675E,
        0x8F609AED2D2D7B4,
        0x18E409353686C14C,
        0xFBCDFC52E01A58B6,
        0xD7F6717D3B435F4E,
        0xD3FCF12428C6C8E8,
        0x35B3D08EE061CF3E,
        0xBABE54539678429,
        0x210D51EAF0C3154,
        0x63998461717B2B59,
        0x698306D7E6685820,
        0xB54904AACAB3F3F,
        0xB6086BA2FB318D05,
        0x223BF765332607F,
        0xD9A238CCBEB4E4EB,
        0xB49788BC8C65DE69,
        0xD99B71B47A8E317B,
        0x528BD19E915EC029,
        0x4D03F2C7444B824E,
        0xE201F1C70606E69,
        0x4E25A3832FFEE3D7,
        0x9CB480D3EC186350,
        0x472A6CF8524B3C64,
        0xDB0EA191431B7112,
        0x38C9044969D99ADF,
        0x13CD2014465EBF8B,
        0x9D33F54059DE7734,
        0xCC1CF6DE37591543,
        0x200E60DD6753055A,
        0x2F3C84818FAFB9C1,
        0x3DACDFA8345A546E,
        0x145BC7BCCB1FF6C8,
    ];
    assert_eq!(res, res_exp);
}
