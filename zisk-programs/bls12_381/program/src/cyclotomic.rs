use ziskos::zisklib::{
    compress_cyclo_bls12_381, decompress_cyclo_bls12_381, exp_by_x_cyclo_bls12_381,
    exp_by_xdiv3_cyclo_bls12_381, exp_by_xone_cyclo_bls12_381, square_cyclo_bls12_381,
};

pub fn cyclotomic_tests() {
    // Compression and decompression: It must happen that D(C(a)) = a
    let a = [
        0x549B29FBE5E940A5, // 0
        0xB11FD6EEF8DAB538, // 1
        0xA1CA6A66D678258,  // 2
        0xA42D9607400A07CF, // 3
        0x707ACF2A119C60C7, // 4
        0x9CFB5CDBDFB170F,  // 5
        0x53502ECA461A0191, // 6
        0x26C49ECB8F9D5E4F, // 7
        0x51B5558A3E20587F, // 8
        0x8BFF542A075AF25A, // 9
        0xF40AD45F69F8F34E, // 10
        0x54010EE2FCE8B2E,  // 11
        0xA69C5A2B114983A6, // 12
        0xBB202F93FDFF68C4, // 13
        0x6CCABE069EB66045, // 14
        0x5C265EEFF42B0001, // 15
        0x5183FF569D4E788A, // 16
        0x181B92344A97B2BE, // 17
        0x1DEE96DD0E3E50CA, // 18
        0xD65C7694187F771C, // 19
        0xFD4CF86BFA7DA384, // 20
        0xEFF11B68853690F3, // 21
        0xCEFD33C061BAC175, // 22
        0x1828B41889E6745A, // 23
        0xEA514E835C30FFA6, // 24
        0x726014205CA6E4DA, // 25
        0xBCDB58F78CDC23E9, // 26
        0xAAD6D14A09B91556, // 27
        0x2BC83DE4767D582C, // 28
        0x152C9372D5C5379F, // 29
        0xC12E567AAFA5E20B, // 30
        0xA7CAF65C22BAC0BB, // 31
        0xF3326A32E339321B, // 32
        0x6C872F426CFA0118, // 33
        0xA5F565BFF148C57D, // 34
        0xF63C4BEE282D774,  // 35
        0x4F77F5A593CF5FA3, // 36
        0xE2AC57399BE68267, // 37
        0x9BBBC9B7155768C3, // 38
        0x5452D80BEB58D910, // 39
        0xDD94F8A9F44DFF98, // 40
        0x55C3A150DE9F27D,  // 41
        0x135AB0991F958AEF, // 42
        0x65D83E06F795F295, // 43
        0x7349E2CF032A7C9,  // 44
        0x7895EA3828AD67D8, // 45
        0xA2BAD2570E688209, // 46
        0x80686FCF89EA3BE,  // 47
        0x8373AE7C9B601F3D, // 48
        0x343B9B7C279E547F, // 49
        0x1A582B06BFDB925B, // 50
        0x5045E66CC8657FB9, // 51
        0xEFFC4EC21DD46D99, // 52
        0x11F5E6BD624A29D8, // 53
        0x88092A6206CC58C3, // 54
        0xBEF07A74921F06BB, // 55
        0x3C6FB0F05F167B86, // 56
        0x50DBBF88415386A2, // 57
        0x84ED238CB32B2791, // 58
        0x19AA5557F245B2CA, // 59
        0x57AC462E389AEEB9, // 60
        0xF5505D61197A00AC, // 61
        0x83BFCF87B2F40996, // 62
        0x91A18C2E1C4E5C33, // 63
        0x6560617243B5E382, // 64
        0x832F3FEF66F64B4,  // 65
        0x19E0F3FA2899F03B, // 66
        0xCF6374A8A9C29BED, // 67
        0xC3EACE6873451DB6, // 68
        0x6E464093AA549B95, // 69
        0x9DC030A689F045F3, // 70
        0x7E850BC5BF5DCB8,  // 71
    ];
    let res = compress_cyclo_bls12_381(&a);
    let res_exp = [
        0x4F77F5A593CF5FA3, // 36
        0xE2AC57399BE68267, // 37
        0x9BBBC9B7155768C3, // 38
        0x5452D80BEB58D910, // 39
        0xDD94F8A9F44DFF98, // 40
        0x55C3A150DE9F27D,  // 41
        0x135AB0991F958AEF, // 42
        0x65D83E06F795F295, // 43
        0x7349E2CF032A7C9,  // 44
        0x7895EA3828AD67D8, // 45
        0xA2BAD2570E688209, // 46
        0x80686FCF89EA3BE,  // 47
        0xEA514E835C30FFA6, // 24
        0x726014205CA6E4DA, // 25
        0xBCDB58F78CDC23E9, // 26
        0xAAD6D14A09B91556, // 27
        0x2BC83DE4767D582C, // 28
        0x152C9372D5C5379F, // 29
        0xC12E567AAFA5E20B, // 30
        0xA7CAF65C22BAC0BB, // 31
        0xF3326A32E339321B, // 32
        0x6C872F426CFA0118, // 33
        0xA5F565BFF148C57D, // 34
        0xF63C4BEE282D774,  // 35
        0xA69C5A2B114983A6, // 12
        0xBB202F93FDFF68C4, // 13
        0x6CCABE069EB66045, // 14
        0x5C265EEFF42B0001, // 15
        0x5183FF569D4E788A, // 16
        0x181B92344A97B2BE, // 17
        0x1DEE96DD0E3E50CA, // 18
        0xD65C7694187F771C, // 19
        0xFD4CF86BFA7DA384, // 20
        0xEFF11B68853690F3, // 21
        0xCEFD33C061BAC175, // 22
        0x1828B41889E6745A, // 23
        0x57AC462E389AEEB9, // 60
        0xF5505D61197A00AC, // 61
        0x83BFCF87B2F40996, // 62
        0x91A18C2E1C4E5C33, // 63
        0x6560617243B5E382, // 64
        0x832F3FEF66F64B4,  // 65
        0x19E0F3FA2899F03B, // 66
        0xCF6374A8A9C29BED, // 67
        0xC3EACE6873451DB6, // 68
        0x6E464093AA549B95, // 69
        0x9DC030A689F045F3, // 70
        0x7E850BC5BF5DCB8,  // 71
    ];
    assert_eq!(res, res_exp);

    let res = decompress_cyclo_bls12_381(&res);
    let res_exp = a;
    assert_eq!(res, res_exp);

    // (decompression with a2 = 0)
    let a = [
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0xEA514E835C30FFA6,
        0x726014205CA6E4DA,
        0xBCDB58F78CDC23E9,
        0xAAD6D14A09B91556,
        0x2BC83DE4767D582C,
        0x152C9372D5C5379F,
        0xC12E567AAFA5E20B,
        0xA7CAF65C22BAC0BB,
        0xF3326A32E339321B,
        0x6C872F426CFA0118,
        0xA5F565BFF148C57D,
        0xF63C4BEE282D774,
        0xA69C5A2B114983A6,
        0xBB202F93FDFF68C4,
        0x6CCABE069EB66045,
        0x5C265EEFF42B0001,
        0x5183FF569D4E788A,
        0x181B92344A97B2BE,
        0x1DEE96DD0E3E50CA,
        0xD65C7694187F771C,
        0xFD4CF86BFA7DA384,
        0xEFF11B68853690F3,
        0xCEFD33C061BAC175,
        0x1828B41889E6745A,
        0x57AC462E389AEEB9,
        0xF5505D61197A00AC,
        0x83BFCF87B2F40996,
        0x91A18C2E1C4E5C33,
        0x6560617243B5E382,
        0x832F3FEF66F64B4,
        0x19E0F3FA2899F03B,
        0xCF6374A8A9C29BED,
        0xC3EACE6873451DB6,
        0x6E464093AA549B95,
        0x9DC030A689F045F3,
        0x7E850BC5BF5DCB8,
    ];
    let res = decompress_cyclo_bls12_381(&a);
    let res_exp = [
        0xE4A8A6D0157C81C7,
        0xFD3CEEB695275100,
        0x6CBA0A915461E80F,
        0xCBF29A1BF0F1701D,
        0x5627337953686E62,
        0xC37D138FA06A777,
        0xB40D54585C9F4D1F,
        0x13A016605E7E7A0D,
        0x3B1650EE53DE1431,
        0x5DD7175C49E39568,
        0x1CC5CA94C56DF79A,
        0x15983608F5E68CA1,
        0xA69C5A2B114983A6,
        0xBB202F93FDFF68C4,
        0x6CCABE069EB66045,
        0x5C265EEFF42B0001,
        0x5183FF569D4E788A,
        0x181B92344A97B2BE,
        0x1DEE96DD0E3E50CA,
        0xD65C7694187F771C,
        0xFD4CF86BFA7DA384,
        0xEFF11B68853690F3,
        0xCEFD33C061BAC175,
        0x1828B41889E6745A,
        0xEA514E835C30FFA6,
        0x726014205CA6E4DA,
        0xBCDB58F78CDC23E9,
        0xAAD6D14A09B91556,
        0x2BC83DE4767D582C,
        0x152C9372D5C5379F,
        0xC12E567AAFA5E20B,
        0xA7CAF65C22BAC0BB,
        0xF3326A32E339321B,
        0x6C872F426CFA0118,
        0xA5F565BFF148C57D,
        0xF63C4BEE282D774,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x0,
        0x99AC5D1072C76352,
        0x7A868FBEEE906EB1,
        0xAF5408F2E990CFFE,
        0x528F6E25721746D4,
        0x1FD11630F34A5859,
        0xEA47483449C3B1A,
        0xB0DB7E67CDDE6FEF,
        0x9D9C8D4BC806E34D,
        0xAF1F7754E323CAAA,
        0xE67FBD31F8EEA7A5,
        0x1BAFAD2B4F5E9295,
        0xD680FC29AB6A276,
        0x57AC462E389AEEB9,
        0xF5505D61197A00AC,
        0x83BFCF87B2F40996,
        0x91A18C2E1C4E5C33,
        0x6560617243B5E382,
        0x832F3FEF66F64B4,
        0x19E0F3FA2899F03B,
        0xCF6374A8A9C29BED,
        0xC3EACE6873451DB6,
        0x6E464093AA549B95,
        0x9DC030A689F045F3,
        0x7E850BC5BF5DCB8,
    ];
    assert_eq!(res, res_exp);

    // Squaring: It must happen that D(C(a²)) = a²
    let a = [
        0x4F77F5A593CF5FA3,
        0xE2AC57399BE68267,
        0x9BBBC9B7155768C3,
        0x5452D80BEB58D910,
        0xDD94F8A9F44DFF98,
        0x55C3A150DE9F27D,
        0x135AB0991F958AEF,
        0x65D83E06F795F295,
        0x7349E2CF032A7C9,
        0x7895EA3828AD67D8,
        0xA2BAD2570E688209,
        0x80686FCF89EA3BE,
        0xEA514E835C30FFA6,
        0x726014205CA6E4DA,
        0xBCDB58F78CDC23E9,
        0xAAD6D14A09B91556,
        0x2BC83DE4767D582C,
        0x152C9372D5C5379F,
        0xC12E567AAFA5E20B,
        0xA7CAF65C22BAC0BB,
        0xF3326A32E339321B,
        0x6C872F426CFA0118,
        0xA5F565BFF148C57D,
        0xF63C4BEE282D774,
        0xA69C5A2B114983A6,
        0xBB202F93FDFF68C4,
        0x6CCABE069EB66045,
        0x5C265EEFF42B0001,
        0x5183FF569D4E788A,
        0x181B92344A97B2BE,
        0x1DEE96DD0E3E50CA,
        0xD65C7694187F771C,
        0xFD4CF86BFA7DA384,
        0xEFF11B68853690F3,
        0xCEFD33C061BAC175,
        0x1828B41889E6745A,
        0x57AC462E389AEEB9,
        0xF5505D61197A00AC,
        0x83BFCF87B2F40996,
        0x91A18C2E1C4E5C33,
        0x6560617243B5E382,
        0x832F3FEF66F64B4,
        0x19E0F3FA2899F03B,
        0xCF6374A8A9C29BED,
        0xC3EACE6873451DB6,
        0x6E464093AA549B95,
        0x9DC030A689F045F3,
        0x7E850BC5BF5DCB8,
    ];
    let res = square_cyclo_bls12_381(&a);
    let res_exp = [
        0x1DB079ECB01C9DB4,
        0x494A8B6209C76D0A,
        0xC8B9276006398407,
        0x812B7CD2BBED8F58,
        0xA1523D0F6A48DDD7,
        0x878762257448041,
        0xF47D6FC2A8A9A7DB,
        0x3292B9D749A3F88D,
        0xC1288F6585EF88D9,
        0x6D410936A9199893,
        0x2EFB378DEA562A0C,
        0xA647585800248BE,
        0x9B47CE875D98AC18,
        0x82F1C7335165227D,
        0x710C74444EA5CE06,
        0x6EE783C797B85796,
        0xB90383549B134138,
        0x1203249546F27E87,
        0x569BF34487FE2B87,
        0xBD44EF4CB4D2E96,
        0xCFA99F6690729597,
        0xC219929C6743945C,
        0xC4994BA2EA6314A5,
        0x177D974AF323DA2,
        0xADDE21779A6388E8,
        0x4D5EE6DAA42EFC7F,
        0x8B6C13FC4F580B1,
        0x27AE0483475B8A19,
        0x8F8A6726F6384488,
        0x19396A9279C5CF7A,
        0xE04A751B8F6A69AF,
        0x563DB95EF58731C0,
        0xE92A0D50E5DA9AE3,
        0x706F768D2CF0C3C4,
        0xCB91B8AC1D680517,
        0xD17C50B7418D4B4,
        0x44B2F2CD0984812F,
        0xFDD0CB6AB85DA8DA,
        0x4665BED8BE9C4E51,
        0xC471208D1CB01C25,
        0x3B5D02F33300D813,
        0x13B7BED71EB982C1,
        0xA67EB9A626A62A5A,
        0x30A4695174C3D182,
        0x7843FED1CF92904E,
        0x8DE3F370727C2722,
        0xFA95A4B82106AAC2,
        0x12816F68C5E544CE,
    ];
    assert_eq!(res, res_exp);

    let a = res;
    let res = decompress_cyclo_bls12_381(&a);
    let res_exp = [
        0x4A2A9B70011E28B1,
        0x8431079A18CC7290,
        0x532856D563340BD1,
        0x962FF820EB5CE7F0,
        0x35D258BB918214BA,
        0x618610BFE1763F4,
        0x5E52B10E231BDB59,
        0x868A0CD770F2C515,
        0x9861B5CA29F727A1,
        0xCCB9EF67E28AE4CB,
        0xC129A0EB4785B8FC,
        0x28F9DFDA5414542,
        0xADDE21779A6388E8,
        0x4D5EE6DAA42EFC7F,
        0x8B6C13FC4F580B1,
        0x27AE0483475B8A19,
        0x8F8A6726F6384488,
        0x19396A9279C5CF7A,
        0xE04A751B8F6A69AF,
        0x563DB95EF58731C0,
        0xE92A0D50E5DA9AE3,
        0x706F768D2CF0C3C4,
        0xCB91B8AC1D680517,
        0xD17C50B7418D4B4,
        0x9B47CE875D98AC18,
        0x82F1C7335165227D,
        0x710C74444EA5CE06,
        0x6EE783C797B85796,
        0xB90383549B134138,
        0x1203249546F27E87,
        0x569BF34487FE2B87,
        0xBD44EF4CB4D2E96,
        0xCFA99F6690729597,
        0xC219929C6743945C,
        0xC4994BA2EA6314A5,
        0x177D974AF323DA2,
        0x1DB079ECB01C9DB4,
        0x494A8B6209C76D0A,
        0xC8B9276006398407,
        0x812B7CD2BBED8F58,
        0xA1523D0F6A48DDD7,
        0x878762257448041,
        0xF47D6FC2A8A9A7DB,
        0x3292B9D749A3F88D,
        0xC1288F6585EF88D9,
        0x6D410936A9199893,
        0x2EFB378DEA562A0C,
        0xA647585800248BE,
        0x6283D34B098BC37D,
        0xC4AB3EC5BC53615,
        0x73AD4A33C1A9846B,
        0x910468DA1835E869,
        0x6E6721DE7089EBAB,
        0xB7DB722A1B08455,
        0x48C79A35AE64046D,
        0x70CF3A232C1C545F,
        0x7FCA71E5397BEB2E,
        0xF5275F5FD048669C,
        0x6357AF539BC95266,
        0x49B99B99D20377C,
        0x44B2F2CD0984812F,
        0xFDD0CB6AB85DA8DA,
        0x4665BED8BE9C4E51,
        0xC471208D1CB01C25,
        0x3B5D02F33300D813,
        0x13B7BED71EB982C1,
        0xA67EB9A626A62A5A,
        0x30A4695174C3D182,
        0x7843FED1CF92904E,
        0x8DE3F370727C2722,
        0xFA95A4B82106AAC2,
        0x12816F68C5E544CE,
    ];
    assert_eq!(res, res_exp);

    // Exponentiation by x using the compression/decompression technique
    let a = [0; 72];
    let res = exp_by_x_cyclo_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    let mut a = [0; 72];
    a[0] = 1;
    let res = exp_by_x_cyclo_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    let a = [
        0x549B29FBE5E940A5,
        0xB11FD6EEF8DAB538,
        0xA1CA6A66D678258,
        0xA42D9607400A07CF,
        0x707ACF2A119C60C7,
        0x9CFB5CDBDFB170F,
        0x53502ECA461A0191,
        0x26C49ECB8F9D5E4F,
        0x51B5558A3E20587F,
        0x8BFF542A075AF25A,
        0xF40AD45F69F8F34E,
        0x54010EE2FCE8B2E,
        0xA69C5A2B114983A6,
        0xBB202F93FDFF68C4,
        0x6CCABE069EB66045,
        0x5C265EEFF42B0001,
        0x5183FF569D4E788A,
        0x181B92344A97B2BE,
        0x1DEE96DD0E3E50CA,
        0xD65C7694187F771C,
        0xFD4CF86BFA7DA384,
        0xEFF11B68853690F3,
        0xCEFD33C061BAC175,
        0x1828B41889E6745A,
        0xEA514E835C30FFA6,
        0x726014205CA6E4DA,
        0xBCDB58F78CDC23E9,
        0xAAD6D14A09B91556,
        0x2BC83DE4767D582C,
        0x152C9372D5C5379F,
        0xC12E567AAFA5E20B,
        0xA7CAF65C22BAC0BB,
        0xF3326A32E339321B,
        0x6C872F426CFA0118,
        0xA5F565BFF148C57D,
        0xF63C4BEE282D774,
        0x4F77F5A593CF5FA3,
        0xE2AC57399BE68267,
        0x9BBBC9B7155768C3,
        0x5452D80BEB58D910,
        0xDD94F8A9F44DFF98,
        0x55C3A150DE9F27D,
        0x135AB0991F958AEF,
        0x65D83E06F795F295,
        0x7349E2CF032A7C9,
        0x7895EA3828AD67D8,
        0xA2BAD2570E688209,
        0x80686FCF89EA3BE,
        0x8373AE7C9B601F3D,
        0x343B9B7C279E547F,
        0x1A582B06BFDB925B,
        0x5045E66CC8657FB9,
        0xEFFC4EC21DD46D99,
        0x11F5E6BD624A29D8,
        0x88092A6206CC58C3,
        0xBEF07A74921F06BB,
        0x3C6FB0F05F167B86,
        0x50DBBF88415386A2,
        0x84ED238CB32B2791,
        0x19AA5557F245B2CA,
        0x57AC462E389AEEB9,
        0xF5505D61197A00AC,
        0x83BFCF87B2F40996,
        0x91A18C2E1C4E5C33,
        0x6560617243B5E382,
        0x832F3FEF66F64B4,
        0x19E0F3FA2899F03B,
        0xCF6374A8A9C29BED,
        0xC3EACE6873451DB6,
        0x6E464093AA549B95,
        0x9DC030A689F045F3,
        0x7E850BC5BF5DCB8,
    ];
    let res = exp_by_x_cyclo_bls12_381(&a);
    let res_exp = [
        0x85C8CDF05B67316,
        0x3975818880DDECCE,
        0xFDB05384C4640D7F,
        0xC7BB35CCBCEFA565,
        0x1D07AEC7F71789AB,
        0xD7570ED58F9144D,
        0x1E869B7FCEA4B96E,
        0x10A23C2DFD41832A,
        0xDD3716D900969F69,
        0xD9E27113289ACB89,
        0x5AE96018C24F0D4B,
        0x13F68EE2F88867E4,
        0x7CF178A58EEA7C9E,
        0x4C0618E7B15C1D10,
        0xC41596E27190C989,
        0x768E4025DFA63C1C,
        0xFEB8E5CADFFD3962,
        0x14A4C1A6E3964F0A,
        0xCB27003644B2C3FA,
        0x2C01A4DB06C6D329,
        0x4E4CE2F8BC6DC2F0,
        0x6B2DBB80E3DB8112,
        0x834088AB34EF6D31,
        0xF940C3DFF537227,
        0xA062EAB9FD466310,
        0xAF1D16DC81DDE1B,
        0x69C6C4027C5C0D3F,
        0x319B1CCAB8DCECA1,
        0xA8F8732D6BE387AB,
        0x11AAA80237C7B110,
        0xA277C512FCA8BDB4,
        0x473EBBFD17AA10EF,
        0x2EB0B6F91D1460B8,
        0x546AAE93968FE4D5,
        0xF9ACC927D180CBE0,
        0x2CE8B36D8DBC9BF,
        0xDEE5B1F000B1E2E3,
        0xEFA36D8FB9D382DB,
        0x7ABA6F049BD9CA76,
        0xA0C59E387CFA6E8A,
        0x37E5E4316D1AC428,
        0x126722F87D697B3F,
        0xDB607D54C28B9568,
        0x292C9BDEDAB5988,
        0x75529BB6D37CAE66,
        0xAB517B6AA43878,
        0xE8AA44A4C2DF91A9,
        0x3B46E6F303FFEF4,
        0x4CA1E709D1BAB2A7,
        0xA2EBA9752B767C3,
        0xDCC058D71BC5E9D4,
        0x265837A0F5D89529,
        0xF42A91D03B027885,
        0x41C83C108943A75,
        0x972AA999D7CE73F9,
        0x489B39175C121FAD,
        0xCC719C198AFC7C35,
        0xA9FC01A354848B44,
        0x3E1D545CC5A8AC51,
        0xC000681DD96BFD3,
        0x48D82B593CF62A60,
        0x52F2262FC4C9BCDD,
        0xF4EED2800218923,
        0x52C4DF0A8EE8903C,
        0x6FAD08DB487F5378,
        0x11AAD7357671A026,
        0x23818F8AFA071823,
        0x357C44CC0532D609,
        0xC92D98C024AB246A,
        0x1C6B9D68D6C10A8F,
        0x47C53965717B3F4A,
        0xA708D86B5346DBD,
    ];
    assert_eq!(res, res_exp);

    // Exponentiation by x+1 using the compression/decompression technique
    let a = [0; 72];
    let res = exp_by_xone_cyclo_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    let mut a = [0; 72];
    a[0] = 1;
    let res = exp_by_xone_cyclo_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    let a = [
        0x549B29FBE5E940A5,
        0xB11FD6EEF8DAB538,
        0xA1CA6A66D678258,
        0xA42D9607400A07CF,
        0x707ACF2A119C60C7,
        0x9CFB5CDBDFB170F,
        0x53502ECA461A0191,
        0x26C49ECB8F9D5E4F,
        0x51B5558A3E20587F,
        0x8BFF542A075AF25A,
        0xF40AD45F69F8F34E,
        0x54010EE2FCE8B2E,
        0xA69C5A2B114983A6,
        0xBB202F93FDFF68C4,
        0x6CCABE069EB66045,
        0x5C265EEFF42B0001,
        0x5183FF569D4E788A,
        0x181B92344A97B2BE,
        0x1DEE96DD0E3E50CA,
        0xD65C7694187F771C,
        0xFD4CF86BFA7DA384,
        0xEFF11B68853690F3,
        0xCEFD33C061BAC175,
        0x1828B41889E6745A,
        0xEA514E835C30FFA6,
        0x726014205CA6E4DA,
        0xBCDB58F78CDC23E9,
        0xAAD6D14A09B91556,
        0x2BC83DE4767D582C,
        0x152C9372D5C5379F,
        0xC12E567AAFA5E20B,
        0xA7CAF65C22BAC0BB,
        0xF3326A32E339321B,
        0x6C872F426CFA0118,
        0xA5F565BFF148C57D,
        0xF63C4BEE282D774,
        0x4F77F5A593CF5FA3,
        0xE2AC57399BE68267,
        0x9BBBC9B7155768C3,
        0x5452D80BEB58D910,
        0xDD94F8A9F44DFF98,
        0x55C3A150DE9F27D,
        0x135AB0991F958AEF,
        0x65D83E06F795F295,
        0x7349E2CF032A7C9,
        0x7895EA3828AD67D8,
        0xA2BAD2570E688209,
        0x80686FCF89EA3BE,
        0x8373AE7C9B601F3D,
        0x343B9B7C279E547F,
        0x1A582B06BFDB925B,
        0x5045E66CC8657FB9,
        0xEFFC4EC21DD46D99,
        0x11F5E6BD624A29D8,
        0x88092A6206CC58C3,
        0xBEF07A74921F06BB,
        0x3C6FB0F05F167B86,
        0x50DBBF88415386A2,
        0x84ED238CB32B2791,
        0x19AA5557F245B2CA,
        0x57AC462E389AEEB9,
        0xF5505D61197A00AC,
        0x83BFCF87B2F40996,
        0x91A18C2E1C4E5C33,
        0x6560617243B5E382,
        0x832F3FEF66F64B4,
        0x19E0F3FA2899F03B,
        0xCF6374A8A9C29BED,
        0xC3EACE6873451DB6,
        0x6E464093AA549B95,
        0x9DC030A689F045F3,
        0x7E850BC5BF5DCB8,
    ];
    let res = exp_by_xone_cyclo_bls12_381(&a);
    let res_exp = [
        0x4784A91C7D6A345C,
        0x6F243955FFE3E8BE,
        0x83FF272E7D14E994,
        0x935CB9853EFB71DC,
        0xBEB0D9599E29237A,
        0x3240F814C0796FA,
        0xEFB86FAE8FD3D899,
        0x4DBEBE4EADFE922D,
        0x41520920BE2EC40D,
        0x98B6B709EED0A0E,
        0xB1BA55CF5FC60183,
        0xE707DB65D9E4BEC,
        0x8A798FE8C14460F7,
        0xD94843B712C8B106,
        0xAA008F584BD1326A,
        0x2A494221EB6B26C0,
        0xD8A35148744E9C6E,
        0xA763E062DB5C86D,
        0x7ED359A57F0C8E3E,
        0x39BB586E576DD2C0,
        0x465EAC420E599C65,
        0xE5B76ACBE70721F3,
        0xBE20E68F5FB6AC5F,
        0x193AB8772A037C5E,
        0x609E5A39533A237D,
        0x229BB726F3B5AC41,
        0x34234F2B6298457C,
        0x33426CC265F7D903,
        0x14FCB3128462D8EB,
        0x16A83BA1F33240C0,
        0x4188A5DF6A45345D,
        0x7EAA6A9F18C318C3,
        0x4147DA85751AC814,
        0x4A29BB142CD56A85,
        0x7F6748F37F4FB210,
        0x549A416E9ECF160,
        0x666274C7FA551932,
        0x417988818E0AB739,
        0xE7FE4ACAC98F39F0,
        0x232DE4BBF43935AC,
        0x9609114961AF0A7E,
        0xC86707A22DF9A16,
        0xEB3C9344D09E44ED,
        0xC44591390B9A5D85,
        0x686DFD3F65AB2FBF,
        0x3E2B894F21945551,
        0x39E1308DF3923F00,
        0x5814839F5EAFC9C,
        0x33F987BB4058854D,
        0x8CAFC15670893D6E,
        0x831C36B83BDD3488,
        0xF6701E687ACEFF98,
        0x6651C5537D24B96E,
        0x14ABAC1CEBE5306A,
        0x9AF17C9E38236B0B,
        0xD1CCD847867FFF30,
        0x3C935AEF2A0F76E,
        0xCF777859F8B1241A,
        0xE598881C29B875A,
        0x1984614EC85F7FA7,
        0x87CE161D57BD634D,
        0xC53F5E7724E1CF11,
        0x7A8C79585F7288E5,
        0x6872AE1BDA83B909,
        0xEDB9901D6F735EA1,
        0x19184CAFA7A6B6E1,
        0xA1A49F6007D9A6AE,
        0xB6E5746E9B26A4D3,
        0x1A90E21B23C925C1,
        0x30FB79CD5E67F61E,
        0x5F6C2DE5F770919A,
        0xF0788C902F707B9,
    ];
    assert_eq!(res, res_exp);

    // Exponentiation by (x+1)/3 using the compression/decompression technique
    let a = [0; 72];
    let res = exp_by_xone_cyclo_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    let mut a = [0; 72];
    a[0] = 1;
    let res = exp_by_xdiv3_cyclo_bls12_381(&a);
    let res_exp = a;
    assert_eq!(res, res_exp);

    let a = [
        0x549B29FBE5E940A5,
        0xB11FD6EEF8DAB538,
        0xA1CA6A66D678258,
        0xA42D9607400A07CF,
        0x707ACF2A119C60C7,
        0x9CFB5CDBDFB170F,
        0x53502ECA461A0191,
        0x26C49ECB8F9D5E4F,
        0x51B5558A3E20587F,
        0x8BFF542A075AF25A,
        0xF40AD45F69F8F34E,
        0x54010EE2FCE8B2E,
        0xA69C5A2B114983A6,
        0xBB202F93FDFF68C4,
        0x6CCABE069EB66045,
        0x5C265EEFF42B0001,
        0x5183FF569D4E788A,
        0x181B92344A97B2BE,
        0x1DEE96DD0E3E50CA,
        0xD65C7694187F771C,
        0xFD4CF86BFA7DA384,
        0xEFF11B68853690F3,
        0xCEFD33C061BAC175,
        0x1828B41889E6745A,
        0xEA514E835C30FFA6,
        0x726014205CA6E4DA,
        0xBCDB58F78CDC23E9,
        0xAAD6D14A09B91556,
        0x2BC83DE4767D582C,
        0x152C9372D5C5379F,
        0xC12E567AAFA5E20B,
        0xA7CAF65C22BAC0BB,
        0xF3326A32E339321B,
        0x6C872F426CFA0118,
        0xA5F565BFF148C57D,
        0xF63C4BEE282D774,
        0x4F77F5A593CF5FA3,
        0xE2AC57399BE68267,
        0x9BBBC9B7155768C3,
        0x5452D80BEB58D910,
        0xDD94F8A9F44DFF98,
        0x55C3A150DE9F27D,
        0x135AB0991F958AEF,
        0x65D83E06F795F295,
        0x7349E2CF032A7C9,
        0x7895EA3828AD67D8,
        0xA2BAD2570E688209,
        0x80686FCF89EA3BE,
        0x8373AE7C9B601F3D,
        0x343B9B7C279E547F,
        0x1A582B06BFDB925B,
        0x5045E66CC8657FB9,
        0xEFFC4EC21DD46D99,
        0x11F5E6BD624A29D8,
        0x88092A6206CC58C3,
        0xBEF07A74921F06BB,
        0x3C6FB0F05F167B86,
        0x50DBBF88415386A2,
        0x84ED238CB32B2791,
        0x19AA5557F245B2CA,
        0x57AC462E389AEEB9,
        0xF5505D61197A00AC,
        0x83BFCF87B2F40996,
        0x91A18C2E1C4E5C33,
        0x6560617243B5E382,
        0x832F3FEF66F64B4,
        0x19E0F3FA2899F03B,
        0xCF6374A8A9C29BED,
        0xC3EACE6873451DB6,
        0x6E464093AA549B95,
        0x9DC030A689F045F3,
        0x7E850BC5BF5DCB8,
    ];
    let res = exp_by_xdiv3_cyclo_bls12_381(&a);
    let res_exp = [
        0xD3655750D13EC2C0,
        0xFCBC5578E44D3A8F,
        0x66372D5CF97A2F41,
        0xB91DD67050EFD96,
        0xB690217159C90B2F,
        0x5053D1CF6709918,
        0x3E53FDC303060C4F,
        0xF6F0B5FA3547F1AD,
        0x95E5FB3CF19B1D6C,
        0x2EFFA06171BCCF5,
        0xDBD5501C6234F362,
        0x13167DD05B68B06,
        0xA146D34F8ABEBE38,
        0x4ADF873B8310F75B,
        0x2FE0F69E23226F30,
        0xC888FB3982965B92,
        0x2C2C2D16DC4BC8A7,
        0xEC14D5827698A2,
        0xE74584584D55AB98,
        0x3DF565F007F849AD,
        0x37AA4CF8AE50C99E,
        0xA08CC98E18A027FF,
        0xBEC3E9AB42E6F280,
        0xD57924C1B8106A5,
        0xA33C2B1AD9876C5C,
        0x86D377CE6A3C3E5B,
        0xCF81DB705AC86CE8,
        0x83BAC9908A4146EE,
        0x47DB4A72D31C6C50,
        0x1309DACCF938AAF5,
        0x5C996C10DFAF84D1,
        0xE7295C4412411D55,
        0x208B1EAB83A1B7C8,
        0xF0D390CE2DFC9631,
        0x7689797A3BC9CE86,
        0x15079C4DFDB08751,
        0x23B6638A8C817CCD,
        0xE79AFBB98A4595E2,
        0x3C579445570DABFD,
        0x1C7428E3B113D05F,
        0xD23063D55E6AE643,
        0x66D7A1BB3E08833,
        0x42352CA0C209F44C,
        0x92544DC19A2363BF,
        0xE7CE79FB012ED14B,
        0xE285398B81E54CA5,
        0x1E35A914CA12BF2D,
        0x10A17E59838A836E,
        0xDBAF7C838F91589,
        0x1BF6157D23486921,
        0xE8727574546C4383,
        0x40E0DEFE8540A0D6,
        0x8CF75D5FD981A538,
        0x1131758AB01EBB6B,
        0x70564971A57E94EB,
        0x4E5D5717D1CCFA07,
        0x2A4514CE69B4CEA7,
        0x820A9F0929C40BF6,
        0x577F45248776A3C9,
        0xB905160F880D62,
        0x546D314CC90500FB,
        0x84E8BBDD3B7423EE,
        0x58579736B4E877DA,
        0x1F9AB2963BD3A6D2,
        0xE8F5C0C6E4ADCF98,
        0x1829ECFCD7CDCD3C,
        0xB16D997F78634CDD,
        0x527FB5B37669A86E,
        0xF712E3FB20E727C2,
        0x8DCE47DBA0513653,
        0x2261F53AFFA7A1B7,
        0x54D807AB9B32F7C,
    ];
    assert_eq!(res, res_exp);
}
